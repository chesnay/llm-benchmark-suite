1 GOTO 1010
2 DEF FNDP(X)=PEEK(X)+256*PEEK(X+1):DEF FNLB(X)=(X-32768)AND 255:DEF FNEX(X)=PEEK(X)+256*(PEEK(X)>127):DEF FNRG(X)=-X*(X>=0 AND X<256)-255*(X>255):A0=53200:A1=A0+1:A2=A1+1:A3=A2+1:A4=A3+1:A5=A4+1
5 A6=A5+1:KP=256:KK=KP*KP:DIM NA$(15):T$="":MP=41728:CL=24:TR=34057:CT=TR+128:LG=CT+1043:PR=LG+259:PT=PR+32:DT=PR+256:NC=PEEK(CT+1023)-3:SO=41737:TS=PEEK(PR+29)*26
6 OPENIN "A:NAMES0"
50 IF TS<>0 THEN FOR F=1 TO TS:INPUT#9,NA$(1):NEXT
61 FOR I=0 TO 15:INPUT#9,NA$(I):NEXT I:FOR I=0 TO 9:INPUT#9,RK$(I):NEXT I:CLOSEIN:NA$="":P$=" 0 PCS":A=PR+80
62 Z=PEEK(A):IF Z THEN NA$=NA$+CHR$(Z):A=A+1:GOTO 62
70 SN=PEEK(PR+26):FOR I=1 TO SQR((SN+1)*1.9):READ X$:X$=X$+"":NEXT I:DATA HIDES,TABAC,SUCRE
86 DF=PEEK(PR-3):DAY=FNDP(LG+4*PEEK(LG)-3):YR=INT(DAY/360):DAY=DAY-YR*360:CC=PEEK(PR+25):CP=CT+CL*CC:GOSUB 9180:ME=FNDP(PT+3):NN=PEEK(CP+3):LL=2:PX=1:MT=-1
997 SG=-1
998 |TFILE,"SIGHT.SID",&5E00:|TFILE,"EOM.SID",&6650
999 |INX:FF$="SHIPS.SPR":|LSP,@FF$:Z=PEEK(PR+18):IF Z=1 THEN CHAIN"SEA" ELSE SL=SGN(Z):IF FN DP(42368)<1 THEN SL=0
1000 CHAIN"TOWN"
1010 GOTO 2
9180 Z=SQR(FNDP(PT+7)/FNDP(PT+3)):Z=2*Z:POKE PT+17,(Z-FNEX(PR+7)+4-DF)AND 255:RETURN:DEF FNDP(X)=PEEK(X)+256*PEEK(X+1):DEF FNLB(X)=(X-32768)AND 255:DEF FNEX(X)=PEEK(X)+256*(PEEK(X)>127)
19002 DEF FNRG(X)=-X*(X>=0 AND X<256)-255*(X>255):A0=40510:A1=A0+1:A2=A1+1:A3=A2+1:A4=A3+1:A5=A4+1:A6=A5+1:KP=256:KK=KP*KP:RETURN

