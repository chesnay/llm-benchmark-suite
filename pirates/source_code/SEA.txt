2 DEF FNDP(X)=PEEK(X)+256*PEEK(X+1):DEF FNLB(X)=(X-32768)AND 255:DEF FNEX(X)=PEEK(X)+256*(PEEK(X)>127):DEF FNRG(X)=-X*(X>=0 AND X<256)-255*(X>255):A0=53200:A1=A0+1:A2=A1+1:A3=A2+1:A4=A3+1:A5=A4+1
5 KP=256:VA=&4000:KK=KP*KP:GOTO 2999
7 |SETVAR,V,ZV:RETURN
8 ZV%=0:|GETVAR,V,@ZV%:ZV=ZV%:IF ZV<0 THEN ZV=INT(KK-ABS(ZV)):RETURN ELSE RETURN
9 ZV=0:|SLVAR,V,@ZV%:ZV=ZV%:IF ZV<0 THEN ZV=INT(KK-ABS(ZV)):RETURN ELSE RETURN
30 |WINDOW,X,Y,DX,DY,CO:RETURN
1000 GOSUB 12500:ZZ=INT(DAY/30):GOSUB 1099:ZZ=DAY-ZZ*30+1:T$=T$+STR$(ZZ)+","+STR$(YR+1560+SN*20):T$=T$+"£ CONTINUE A VOYAGEÒ STATUT DU GROUPÅ STATUT PERSONNEÌ JOURNAL DE NAVIRÅ CARTES DU BORÄ":ZZ=(LL=0)*(((PD=0)OR(PD>24))+0.5)
1025 T$=T$+" LES VILLEÓ OBSERVENT LE SOLIEÌ":IF LL=1 THEN T$=T$+" CHERCHÅ"
1028 IF LL AND 2 THEN T$=T$+" SVGRDE LE JEÕ"
1030 X=10:Y=4:GOSUB 8000:A=CP:GOSUB 2950:IF C=1 THEN RETURN
1040 IF C<8 THEN A=PT:ON C GOSUB 1040,2500,1900,7000,2299,2000,6500:GOTO 1000
1090 IF C=8-(ZZ<>0)THEN GOSUB 2400:GOTO 1000
1095 GOTO 1000
1099 T$=MID$("JANFEVMARAVRMAIJINJLTAOUSEPOCTNOVDECJAN",ZZ*3+1,3):RETURN
1900 PRINT"":X=9:Y=2:DX=29:DY=9:CO=3:GOSUB 30:T$="":IF PEEK(PR+20)THEN T$="(MARIE)"
1910 PRINT:PRINT"
STATUT PERSONNEL: "T$:FOR I=1 TO 4:Z=I AND 3:GOSUB 2195:PRINT" "CO$F$;"";:Z=PEEK(PR+13+(I AND 3)):IF Z THEN PRINT RK$(Z):GOTO 1935
1926 Z=FNEX(PR+8+(I AND 3)):IF Z>1 THEN PRINT"(LETTRE DE MARQUE)":GOTO 1935
1927 IF Z>-1 THEN PRINT"(PAS DE TITRE)":GOTO 1935
1928 IF Z>-4 THEN PRINT"AVISE":GOTO 1935
1929 PRINT"HOSTILE"
1935 NEXT I:GOSUB 8435:PRINT" AGE:"YR+25;"";T$" SANTE":PRINT" RICHESSE:"FNDP(PR+2)*10"PCS D'OR":PRINT" TERRE:"PEEK(PR+5)*50"ACRES":|Y,12:PRINT:GOSUB 8420:PRINT"REPUTATION:":PRINT"  "F$" ";:GOSUB 8445:PRINT F$:GOSUB 2980:RETURN
2000 CO$="":GOSUB 12500:T$="TESÔ":|PARSE,@T$:PRINT"
  INFO SUR LA VILLE":PRINT:MO=2:|Y,4:PRINT:PRINT"CHOIX D'UNE VILLE:
":PRINT"(FINIS)":T$="VILLAHERMOSA":FOR K=0 TO NC:|GCITY,@T$,K:IF K/3=INT(K/3)THEN PRINT
2020 A=CT+K*CL+12:Z=PEEK(A-9):PRINT MID$(CO$,Z+1,1);:IF(PEEK(A-12)AND 128)=0 THEN PRINT"";
2022 PRINT" "T$;:NEXT K
2025 |CONTR,5:C=3*(INT(PEEK(A5)/8)-8)+INT(PEEK(A4)/26):IF C>NC THEN C=NC
2036 A=CT+CL*C:IF C<0 THEN RETURN
2040 GOSUB 2140:GOTO 2025
2045 A=CT+CL*C:IF C<0 THEN RETURN
2050 GOSUB 2140:GOTO 2040
2140 |WINDOW,19,0,16,8,3:PRINT CHR$(30);"":GOSUB 2950:PRINT""C$:IF NOT PEEK(A)AND 128 THEN PRINT" 

 PAS D'INFO":RETURN
2165 Z=PEEK(A+3):GOSUB 2195:PRINT" ( "CO$;F$")":Z=PEEK(A+4)AND 15:IF Z THEN PRINT""Z;"FORT(S)"
2180 PRINT""PEEK(A+5)*10;"SOLDATS.":PRINT""(PEEK(A+6)+1)*100;"CITOYENS.":IF PEEK(A+7)THEN PRINT" OR:"PEEK(A+7)",000"
2190 T$="COMBATTANTSURVIVANT PROSPERE  RICHE     ":Z=INT(PEEK(A+8)/64):PRINT" "MID$(T$,Z*10+1,10):RETURN
2195 F$="ESPAGN.ANGLAISFRANC. HOLLD. PIRATE ":CO$=MID$(F$,Z*8+1,1):F$=MID$(F$,Z*8+2,7)
2197 Z=LEN(F$):IF RIGHT$(F$,1)=" "THEN F$=LEFT$(F$,Z-1):GOTO 2197
2199 F$=F$+" ":RETURN
2290 CO$=RK$((Z AND 7)+2)+" "+NA$(INT(Z/8)):RETURN
2299 FOR K=0 TO 2:A=TR+8*K:GOSUB 2300:NEXT:RETURN
2300 IF PEEK(A)=0 THEN RETURN
2305 CALL &BD19:OUT &BC00,1:OUT &BD00,0:AA=A:ZZ=PEEK(A):X=PEEK(A+1):Y=PEEK(A+2):X=(X-4)*64-32:Y=(Y-6)*32:POKE A0,FNLB(X):POKE A1,INT(X/KP):POKE A2,FNLB(Y):POKE A3,INT(Y/KP):CALL MP:INK 9,15:INK 3,12:FOR F=12 TO 15:INK F,12:NEXT:CALL &8503
2311 |TREAS,16+ABS(25*(AA=TR+8)):PRINT""SPACE$(80):FOR J=0 TO 3:IF(ZZ AND(2^J))=0 THEN X=(J AND 1)*21:Y=2+6*(J AND 2):GOSUB 2390
2340 NEXT:IF AA=TR THEN PRINT"  CARTE DU TRESOR DU PIRATE""
2346 IF AA=TR+8 THEN Z=PEEK(PR+6):GOSUB 8430:PRINT"  CARTE DU "T$" PERDU"
2347 IF AA=TR+16 THEN PRINT"  CARTE DU TRESOR INCA PERDU"
2350 IF PEEK(AA)AND 16 THEN A=PEEK(AA+3)*CL+CT:GOSUB 2950:PRINT"  ...A PROXIMITE "C$
2355 CALL &BD19:OUT &BC00,1:OUT &BD00,40
2360 IF INKEY(76)=-1 AND INKEY(6)=-1 THEN 2360
2370 GOSUB 12500:|INX:RETURN
2390 T$=STRING$(4,163)+"    MANQUANT!   "+STRING$(4,163):GOSUB 8005:RETURN
2400 IF LL>=2 THEN 2450
2405 F$="":ZZ=3:GOSUB 9000:X=6:Y=7:FOR K=0 TO 2:AA=TR+8*K:Z=PEEK(AA):IF PEEK(PT+1)<>PEEK(AA+1)OR PEEK(PT+2)<>PEEK(AA+2)OR Z=0 THEN 2445  
2415 Z=PEEK(PR+6):GOSUB 8430:CO$="VOTRE "+T$:C1=15:C2=7:F$="TREASURE":IF K=1 THEN F$="RESCUE"+CHR$((Z AND 1)+48):ZZ=((Z-1)AND 7)+8
2422 XX=1:X=-2:Y=9:GOSUB 8100:FF=47+K:ZZ=-INT(RND*9+5)*100*(K=0):IF K=2 THEN ZZ=10000
2430 SG=3:X=5:Y=1:GOSUB 8590:ZZ=-ZZ:GOSUB 3990:POKE AA,0:IF K<>1 THEN C1=8:C2=0:GOSUB 7900:f$="fred":GOTO 2445
2440 Y=8:FF=43:GOSUB 8590:A=TR+16:GOSUB 3590:C1=26:C2=PEEK(PR+6):GOSUB 7900:C=6:GOSUB 8400:FOR I=4 TO 7:POKE TR+24+I*8,0:NEXT
2445 NEXT:IF f$="" THEN FF=34:GOSUB 8590
2449 RETURN
2490 T$="INSERE "+T$+"£ ET ACTIONNER LA MANETTEÒ":X=6:Y=16:GOSUB 8000:LOAD"ID.BIN",51160:A$=CHR$(PEEK(51160)+48):RETURN
2500 PRINT"
":|WINDOW,2,1,26,9,10:T$="				":GOSUB 9180:PRINT"			GROUPE DE "NA$:PRINT T$"EQUIP.:"FNDP(PT+3)"HOMMES":PRINT T$"CANON:"PEEK(PT+5):PRINT T$"OR:"FNDP(PT+7)P$:Z=KP*PEEK(PT+9)+PEEK(PT+13):PRINT T$"ALIMENT:"INT(Z/FNDP(PT+3))"JOURS":GOSUB 8440
2530 PRINT T$"LE EQUIP. EST "F$:PRINT T$"BIENS:"PEEK(PT+10)"TONNES":PRINT T$""X$":"PEEK(PT+11)"TONNES":T$="PRISONNIERº ":FOR I=88 TO 95:ZZ=PEEK(TR+I):IF ZZ=0 THEN 2570
2565 Z=ZZ AND 127:GOSUB 2290:T$=T$+CO$:F$=" (CHASSUER© ":IF ZZ>127 THEN F$=" (PIRATE© "
2566 T$=T$+F$
2570 NEXT I:IF LEN(T$)>12 THEN X=1:Y=14:GOSUB 8005
2580 T$="NAVIRESº ":GOSUB 5920:X=15:Y=10:GOSUB 8005:GOSUB 2980:RETURN
2950 C$="":FOR I=A+12 TO A+23:C$=C$+CHR$(PEEK(I)):NEXT:IF MO=2 THEN RETURN
2955 Z=LEN(C$):IF RIGHT$(C$,1)=" "THEN C$=LEFT$(C$,Z-1):GOTO 2955
2960 RETURN
2980 PEN 1:XS=X:YS=Y:T$=" ACTIONNEZ LA MANETTÅ":X=9:Y=21:GOSUB 8000:X=XS:Y=YS:|WINDOW,9,21,28,2,co:RETURN
2990 RR=0:IF INKEY(76)<>-1 AND INKEY(6)<>-1 THEN 2990
2992 RR=RR+0.1:IF INKEY(76)=-1 AND INKEY(6)=-1 THEN ON RR/199+1 GOTO 2992,2994
2993 RETURN
2994 GOSUB 2980:GOTO 2993
2999 GOSUB 8500:GOSUB 5000:GOSUB 12500:A=CP:GOSUB 2950:PRINT:PRINT" VOUS ARRIVEZ A "C$"."
3020 ZZ=PEEK(CP+4):IF ZZ>1 THEN PRINT ZZ"FORTS GARDANT L'ENTREE DU PORT."
3021 IF ZZ=1 THEN PRINT"UN FORT GARDANT L'ENTREE DU PORT."
3022 Z=NN:GOSUB 2195:POKE PR+25,CC:PRINT"LES "CO$;F$"DRAPEAU FLOTTANT SUR LA VILLE":IF CC=PEEK(PR-1)THEN PRINT"LA FLOTTE AU TRESOR EST DANS LE PORT!"
3027 IF CC=PEEK(PR-2)THEN PRINT"LE TRAIN D'ARGENT EST DANS LA VILLE":DZ=DZ+1
3030 F$="TOWN1":X=19:Y=8:GOSUB 8100
3032 T$="DIRECTION LE PORÔ":IF LL AND 1 THEN T$="ENTRE DANS LE VILLÅ"
3035 T$="QUE FAIRE¿ "+T$+" ATTAQUER LA VILLÅ SE GLISSER DANS LE VILLÅ QUITTER LA VILLÅ":Z=PEEK(CP+11):VV=VV AND 3:IF VT<>CP THEN MT=-1:VV=0
3042 VT=CP:X=1:Y=6:GOSUB 8000:IF C=4 THEN GOSUB 12500:GOTO 2999
3050 IF C=2 THEN 3100
3055 IF C=3 THEN VV=VV OR 10:GOTO 3800
3060 CX=RND*(FNEX(PR+8+NN)+FNEX(CP+9)-ME/100):IF CX>-0.5 OR PEEK(CP+4)=0 THEN 3200
3070 GOSUB 12500:T$="A VOTRE APPROCHE LE FORÔOUVRE LE FEU®":X=1:Y=2:GOSUB 8005:IF CX>-1 OR LL<>2 THEN 3032
3080 T$="UN DE VOUS BATEAUX EST COULE¡":X=9:Y=12:GOSUB 8000:GOSUB 4900:GOTO 2999
3100 FT=0:XM=0:HT=0:FOR I=1 TO 2:IF PEEK(PR-I)=CC THEN POKE CP+5,FNRG(PEEK(CP+5)+10)
3101 NEXT:IF LL=2 THEN 3110
3102 IF FNDP(PT+3)>PEEK(CP+5)*15 OR PEEK(CP+4)=0 OR PEEK(CP+5)<10 THEN 3122
3103 GOSUB 6700:ZZ=0:GOSUB 3980:IF V=0 THEN 2999
3104 IF PEEK(CP+4)=0 THEN 3160
3106 GOTO 3122
3110 IF PEEK(CP+4)=0 THEN F$="STREET":T$="TOWN":GOTO 3125
3112 FT=1:SA=DT+KP+21*7:POKE SA+2,PEEK(CP+5)/2+0.5:POKE SA+3,12*(PEEK(CP+4)AND 7):POKE SA,8:POKE SA+1,NN:POKE SA+4,0:GOSUB 5460:IF K=0 THEN 2999
3120 V=59:GOSUB 8:POKE CP+5,PEEK(CP+5)/2+ZV/10+0.5
3122 X=3:Y=3:FF=61:GOSUB 8590:T$="FORT":F$="COURT"
3125 Y(1)=3+RND(X)*3:T(1)=5+PEEK(CP+4):GOSUB 8450:T(0)=PEEK(CP+5)*10+5:Y(0)=ME-XM:GOSUB 8300:ZZ=XM:GOSUB 3980:IF V=0 OR DL THEN C=-4:GOSUB 8400:C=-(8+NN):GOSUB 8400:GOTO 2999
3160 V=56:GOSUB 8:POKE CP+5,(ZV+9)/10:GOSUB 8180:T$="CITIZENS":GOSUB 3610:GOTO 2999
3200 P5=FRE(""):POKE &B075,200:POKE &B076,0:POKE &B077,192:CHAIN"TOWN"
3590 F$="TREAS":GOSUB 12900:GOSUB 5950:V=21:ZV=A:GOSUB 7:V=22:ZV=NC:GOSUB 7:GOSUB 12950:GOTO 2300
3610 A$="¿ NO INQUIRÙ":A=CP:GOSUB 2950:K=0:FOR I=4 TO 7:A=TR+24+8*I:IF PEEK(A)=0 THEN 3620
3613 Z=0:FOR J=3 TO 7:Z=Z-((PEEK(A+J)AND 63)=CC):NEXT:IF Z=0 THEN 3620
3615 Z=PEEK(A+1):GOSUB 2290:A$=A$+" "+CO$+"¿":T(K)=I:K=K+1
3620 NEXT:IF K=0 THEN RETURN
3625 T$="LES "+T$:FF=8:GOSUB 8610:T$=T$+A$:A$=T$
3630 X=10:Y=9:GOSUB 8000:IF C<7 THEN RETURN
3640 C=T(C-7):AA=TR+24+C*8:Z=PEEK(AA+1):GOSUB 2290:J=0:FOR I=7 TO 3 STEP-1:IF(PEEK(AA+I)AND 63)=CC THEN ZZ=PEEK(AA+I-1)AND 63:J=I
3655 NEXT:IF J>3 THEN A=CT+CL*ZZ:GOSUB 2950
3658 IF J THEN POKE AA+J,CC+128:C1=9:C2=(C-4)*64
3665 IF J>3 THEN T$=CO$+" ABANDONEE "+C$+"£IL Y A QUELQUES MOIS":C2=C2+ZZ:GOSUB 7900
3670 IF J=3 THEN T$=CO$+" ÙEST A PRESENT "+C$+"£":C2=C2+CC:GOSUB 7900
3690 X=2+C:Y=14-C:GOSUB 8000:T$=A$:IF K>1 THEN 3630
3695 A$RETURN GOSUB"É
3800 IF FNEX(CP+9)*FNEX(PR+4)>-RND*50 THEN 3200
3810 FF=2:X=6:Y=10:GOSUB 8590:F$="STREET":T$="GUARD":DZ=1:GOSUB 8290:GOTO 2999
3940 IF AA=0 THEN Z=FNDP(PR+2):ZZ=-0.1*Z:GOSUB 3995:AA=ZZ
3942 POKE PT+7,FNLB(AA/10):POKE PT+8,AA/10/KP:Z=PEEK(PT+20)AND 7:POKE PT+14,Z*2+2:POKE PT+20,Z:POKE PT+5,Z*2+6:FOR I=10 TO 13:POKE PT+I,0:NEXT:POKE PT+9,15:POKE PT+15,1:ZZ=16+FNEX(PR+4)-ME:GOSUB 3980:POKE PR+7,0:VV=0:RETURN
3960 X=6:Y=13:IF PEEK(PR+18)AND 1 THEN FF=14:GOSUB 8590:GOTO 21000
3961 GOSUB 8435:IF Z=4 THEN FF=60:GOSUB 8590:GOTO 21000
3962 RETURN
3975 GOSUB 3980:ZZ=-ZZ/(ME-ZZ)*FNDP(PT+7):GOSUB 3990:RETURN
3980 ME=FNDP(PT+3)+INT(ZZ):POKE PT+3,FNLB(ME):POKE PT+4,INT(ME/KP):IF ME=0 THEN ZZ=1:GOTO 3980
3982 RETURN
3990 ZZ=FNDP(PT+7)-ZZ:IF ZZ<0 THEN T$="PAS ASSEZ D'OR":GOSUB 7999:RETURN
3992 POKE PT+7,FNLB(ZZ):POKE PT+8,ZZ/KP:RETURN
3995 ZZ=FNDP(PR+2)+ZZ:POKE PR+2,FNLB(ZZ):POKE PR+3,ZZ/KP:RETURN
4000 V=0:Z=NN:GOSUB 2195:IF DD>12 THEN F$="INCONNU "
4015 T$="'VOILE!§OH LA VIGIE CRIE VOILÅA L'HORIZON®":X=2:Y=14:IF DF<2 THEN T$=T$+"'NOUS SOMME DANS LES EAUX "+F$+"§PREVIENT LE MAITRE®"
4025 T$=T$+"DOIT-ON¿ S'INFORMEÒ CONTINUER LE VOYAGÅ":GOSUB 8000:IF C AND 1 THEN RETURN
4030 ZV=INT(RND*(ME/50+WA/6-FNEX(CP+9))/3):IF ZV>4 THEN ZV=4
4040 SA=DT+7*(ZV+5*PEEK(CP+3))+KP:IF(RND<0.4)OR(DD>12)THEN SA=DT+7*INT(RND*20)+KP
4042 IF CC=PEEK(PR-1)AND RND>WA/24 THEN SA=DT+7*20+KP
4049 ZZ=5:GOSUB 4300:ZZ=PEEK(SA):GOSUB 4290:GOSUB 2197:T$="ELLE RESEMBLE Á"+F$+"CAPITAINE®DOIT-ON¿ S'INFORMEÒ VOILE AU LOIÎ":X=1:Y=16:GOSUB 8000:NN=PEEK(SA+1):HT=0:IF PEEK(SA+4)<6 OR FNEX(PR+8+NN)>=0 THEN 4100
4090 Z=INT((NN+RND)*32):IF NN=4 THEN Z=INT((PEEK(CP+3)+RND)*32)
4091 IF Z=0 THEN 4090
4092 GOSUB 2290:DZ=INT((Z AND 7)/3):HT=Z:Z=DZ*20+1:GOSUB 8421:T$="'HUGH! C'EST LE "+F$+"£PIRATE":IF NN<>4 THEN T$=T$+"-CHASSUER"
4094 T$=T$+": "+CO$+"¡IL NOUS POURSUIT, CAPITAINE!§":X=2:Y=2:GOSUB 8005:C=3
4100 Z=NN:GOSUB 2195:IF C<>3 THEN RETURN
4105 ZZ=NN:GOSUB 4310:T$="C'EST LE DRAPEAUX DE "+F$+"£CAPITAINE®DOIT-ON¿ RASSEMBLEMENT POUR BATTAILLÅ VOILE AU LOIÎ CONTINUER LE VOYAGÅ":X=2:Y=14:GOSUB 8000:IF(RND<(DF/3))AND HT THEN V=1:RETURN    
4130 IF C=5 THEN RETURN
4131 IF C=4 AND FNEX(PR+NN+8)>-4 THEN F$="NOUVELLE DE NAVIRE":RR=2:TV=DAY+YR*360:GOTO 7010
4135 POKE CP+9,(FNEX(CP+9)+(DD<7))AND 255:V=1:RETURN
4140 T$="CAPITAINE":F$="DECK":V=59:GOSUB 8:T(0)=ZV:V=9:GOSUB 8:Y(1)=7.9-ZV/16:IF HT THEN T$=CO$
4145 Z=PEEK(SA+4):Y(0)=ME-XM:T(1)=Z-INT(LN/16):DZ=(7 AND HT)/3:GOSUB 8300:ZZ=XM:GOSUB 3980:IF V=0 THEN WA=WA+16:C=-4:GOSUB 8400:GOSUB 8400:RETURN
4152 C1=4:GOSUB 7880
4155 XX=1:X=-11:Y=9:F$="PLUNDER":RD=12:GOSUB 8099:SG=1:ZZ=PEEK(SA):GOSUB 4290:T$="'CAPITAINE, NOUS AVON CAPTURÅ":IF HT THEN Z=HT:GOSUB 2290:T$=T$+CO$+" EÔ"
4158 T$=T$+"UN"+STR$(CX)+" FUSIL "+F$+"£DE"+STR$(ZZ*20+20)+" TONNES. NOUS ":GOSUB 8580:T$=T$+"AVONÓDE PLACE POUR"+STR$(Z)+" TONNES EÎPRISE. LA GARDONS NOUS?§":T$=T$+" OUI, ENVOYEZ UN SUPER EQUIPAGÅ NON,PILLEZ ET COULEZ-LÁ":X=1:Y=1:GOSUB 8000:C=C+(HT<>0)
4161 IF C=6 OR PEEK(PT+15)>6 THEN 4200
4164 Z=PEEK(PT+15):POKE PT+15,Z+1:POKE PT+20+Z,PEEK(SA)+8*INT(LN/16):POKE PT+14,PEEK(PT+14)+PEEK(SA)*2+2:IF Z*8>ME THEN ZZ=Z*8-ME:GOSUB 3980
4200 C=4:GOSUB 8400:T$="CREWMEN":IF NN<>4 THEN C=-NN-8:GOSUB 8400:IF DD<(5+PEEK(SA))THEN GOSUB 9900:GOSUB 3610
4212 IF HT=0 THEN 4219
4213 Z=HT:GOSUB 2290:X=8:Y=4:FF=1:C=0:IF(NN AND 3)=0 THEN GOSUB 8590
4214 IF C=6 THEN GOSUB 4270:GOTO 4219
4215 IF C=7 THEN GOSUB 4275:GOTO 4219
4217 FOR I=88 TO 95:IF PEEK(TR+I)=0 THEN POKE TR+I,HT+(NN AND 4)*32:I=99
4218 NEXT
4219 T(0)=INT((PEEK(CP+8)+64)/16*PEEK(SA+5)*RND):T(1)=(1+RND)*PEEK(SA+2):FOR I=2 TO 4:T(I)=PEEK(SA+6)*RND^2:P(I)=0:NEXT:T$="LAISSEZ":T(4)=CX/2:POKE PT+17,(PEEK(PT+17)+1-(PEEK(SA+4)>5))AND 255:P(0)=0:P(1)=0:GOSUB 8210
4230 ZZ=INT(PEEK(SA+2)*(FNEX(PR+4)+5)*RND/10):IF ZZ<2 THEN 4265
4240 T$="CAPITAINE"+STR$(ZZ)+" LES MARINS VEULENÔSE JOINDRE A NOUÓ LES ACCEPTEÒ LES ARGUEÒ":X=2:Y=16:GOSUB 8000:IF C=2 THEN GOSUB 3980
4265 RETURN
4270 T$="LA FLOTTE AU TRESOÒ":A=1:C$="ESPAGNE":GOTO 4280
4275 T$="LE TRAIN D'ARGENÔ":A=2:C$="PEROU"
4280 Z=FNEX(PR-A):Y=10+A:IF Z>=0 THEN C1=19+A:C2=Z:GOSUB 7900:A=CT+Z*CL:GOSUB 2950
4285 T$=T$+"IS IN "+C$+"£":X=3:GOSUB 8000:RETURN
4290 F$="PINASSE     SLOOP       BARQUE      CARGOS      MARCHAND    FREGATE   ":F$=F$+"  GALION GUE. GALION      FORT":Z=(ZZ AND 7)*12:F$=MID$(F$,Z+1,12):IF(ZZ AND 7)=5 AND SN<4 THEN F$="GALION RAPIDE"
4294 IF ZZ AND 248 THEN F$=F$+" (ABIME)"
4296 RETURN
4300 X=PEEK(SA):IF X=5 AND SN<4 THEN X=8
4305 F$="SHIP"+CHR$(X+48):X=-19*SGN(ZZ):Y=1:GOSUB 8100
4310 T$="200601090026":INK 7,VAL(MID$(T$,ABS(ZZ*2)+1,2)):RETURN
4900 V=0:ZZ=INT(RND*PEEK(PT+15)):GOTO 4910
4905 V=1
4910 IF PEEK(PT+15)=1 THEN 4950
4915 Z=(PEEK(PT+20+ZZ)AND 7)*2+2:CX=PEEK(PT+14):POKE PT+14,CX-Z:CX=(CX-Z)/CX:FOR I=ZZ TO 10:POKE PT+20+I,PEEK(PT+21+I):NEXT:POKE PT+15,PEEK(PT+15)-1:IF V THEN 4949
4930 ZZ=FNDP(PT+7)*(1-CX):GOSUB 3990:FOR I=9 TO 12:POKE PT+I,INT(CX*PEEK(PT+I)):NEXT:POKE PT+5,INT(CX*PEEK(PT+5))
4949 RETURN
4950 GOSUB 12500:X=3:Y=9:F$="ISLAND":GOSUB 8100:X=1:Y=1:FF=30:GOSUB 8595:F$="ISLAND":GOSUB 12900:GOSUB 5950:GOSUB 12950:SL=0:GOSUB 4990:X=1:Y=14:FF=31:GOSUB 8590:RETURN
4990 Z=FRE(0):GOSUB 3960:POKE PR+7,240:XM=0:T$="":FOR J=0 TO 6+FNEX(PR+4)/2:ZZ=27:GOSUB 9000:NEXT:AA=0:GOSUB 3940:GOSUB 8435:X=7:Y=8:IF Z=4 THEN 3960
4996 FF=56+Z:GOSUB 8590:DF=DF-SGN(DF AND 3):POKE PR-3,DF:GOSUB 8445:CO$=F$:RETURN
5000 GOSUB 8500:|CLEAR:IF SL<2 THEN SK=2:GOSUB 5950
5010 IF SL THEN|RSSAIL:V=18:ZV=1:GOSUB 7:GOTO 5090
5040 V=23:ZV=CP:GOSUB 7:V=22:ZV=NC:GOSUB 7:V=19:ZV=0:GOSUB 7
5090 GOSUB 12500:IF WA>15 THEN POKE PR+60+PEEK(CP+3),CC
5095 V=79:ZV=DT:GOSUB 7:SL=2:ZV=INT(3.5-ABS(MN-8)/3):V=12:GOSUB 7:V=4:ZV=WA:GOSUB 7:V=24:ZV=0:GOSUB 7:V=25:ZV=0:GOSUB 7:INK 6,26:|T,&6E00:CALL &BCA7:LN=PEEK(A0):SH=PEEK(PR+128):GOSUB 12500:V=5:GOSUB 8:LL=ZV:V=38:GOSUB 8:PD=ZV
5096 |SVSAIL:V=23:GOSUB 8:CP=ZV:V=4:GOSUB 8:WA=ZV:V=26:GOSUB 8:DD=ZV:CC=(CP-CT)/CL:V=20:GOSUB 8:ZZ=INT(ZV/32)+1:GOSUB 9000:NN=PEEK(CP+3):ON LN GOTO 5450,5300,5350,5365,5000:GOSUB 1000:GOTO 5000
5300 V=11:GOSUB 9:T$="CAPTAIN, WE HAVE ONLÙ"+STR$(ZV)+" DAY'S FOOD LEFÔ":X=8:Y=4:IF ZV THEN GOSUB 8000:GOTO 5000
5320 FF=38:GOSUB 8590:POKE PT+9,5:ZZ=-ME/3:GOSUB 3975:GOTO 5000
5350 FF=37:X=8:Y=5:GOSUB 8590:V=0:ZZ=SH:GOSUB 4910:GOTO 5000
5365 LL=LL OR 2:RETURN
5450 GOSUB 4000:FT=0:IF V=0 THEN WA=WA+16:GOTO 5000
5455 GOSUB 5460:GOTO 5000
5460 LN=INT(RND*3):IF PEEK(PT+15)=1 THEN 5500
5465 Z=ME-PEEK(PT+15)*8+8:ZZ=PEEK(PT+5):IF ZZ>Z/4 THEN ZZ=INT(Z/4)
5470 T$="NOUS AVONS"+STR$(Z)+" HOMMES "+STR$(ZZ)+" CANON®LES VENTS SONT "+MID$("FAIBLEMODEREFORT  ",LN*6+1,6)+". QUELLÅ":T$=T$+"NAVIRE COMMANDEREZ¿ ":GOSUB 5920:X=3:Y=3:T$=MID$(T$,1,LEN(T$)-1):GOSUB 8000:c=c+1:Z=PEEK(PT+20):POKE PT+20,PEEK(PT+16+C)
5480 POKE PT+16+C,Z
5500 GOSUB 12500:VV=0:V=8:GOSUB 8:XM=ZV:IF FT THEN GOSUB 6700 ELSE INK 0,2:INK 6,26:CALL &A309:|CLEAR,1
5510 |CLEAR:CALL &8503:V=8:ZV=XM:GOSUB 7:V=34:ZV=FT:GOSUB 7:V=13:ZV=LN:GOSUB 7:V=35:ZV=CP:GOSUB 7:V=41:ZV=83:GOSUB 7:V=76:ZV=SA:GOSUB 7:SK=3:GOSUB 5950:DZ=0:|Y,20:PRINT:ZZ=PEEK(PT+20)AND 7:GOSUB 4290:PRINT" "F$"   ";:ZZ=PEEK(SA):GOSUB 4290
5560 |X,20:IF FT THEN F$="FORT"
5565 PRINT""F$:PRINT"    CANON,    HMS   CANON,    HMS":PRINT" PAS DE DEGATPAS DE DEGAT":PRINT" CANONS ARMEE";:IF FT=0 THEN PRINT"VOILES DE COMBAT";
5600 |T,&5F00:K=0:ME=FNDP(PT+3):ON PEEK(A0)GOTO 5620,5630,5640,5650,5660,5670,5680,5690,5700,5710,5720,5730
5620 T$="REARMEMENT    ":GOTO 5635
5630 T$="CANONS ARMES   "
5635 |Y,23:PRINT:PRINT"                   ":PRINT" "T$;:GOTO 5600
5640 GOTO 5600
5650 V=13:GOSUB 8:T$=MID$("FAIBLEMODEREFORT  ",ZV*6+1,6)+" LES VENTS SONT ":V=8:GOSUB 8:Z=INT(ZV/16)*3+1:T$=T$+MID$("S  SSWSW WSWW  WNWNW NNWN  NNENE ENEE  ESESE SSE",Z,3):|Y,19:PRINT:PRINT"------"T$"------";:GOTO 5600
5660 GOSUB 5900:GOSUB 12500:INK 0,26:CO$="LE CAPITAINE ENNEMI":IF HT THEN Z=HT:GOSUB 2290
5662 IF FT=0 THEN F$="BOARDING":GOSUB 8097:X=3:Y=1:FF=36:GOSUB 8590:GOSUB 4140
5665 K=1:RETURN
5670 V=36:GOSUB 8:Z=-(ZV=2 OR FT):FF=21+Z:ZZ=FNEX(PR+128):IF ZZ=-1 THEN 5675
5673 A=PEEK(PT+20+ZZ)AND 7:V=0:GOSUB 4910:ZZ=A:GOSUB 4290:GOSUB 2197:CO$=F$:FF=40
5675 GOSUB 12500
5676 C1=6:GOSUB 5900:X=1:Y=14:GOSUB 8590:IF K AND FT=0 THEN GOSUB 4155:C1=4
5677 IF DD<12 AND K=0 THEN WA=WA+24-2*DD
5678 IF FT=0 THEN GOSUB 7880
5679 RETURN
5680 |Y,22:PRINT:V=9:GOSUB 5685:F$="SINKING":XX=1:X=-19:Y=1:IF Z>=4 THEN GOSUB 8100:GOTO 5688
5682 |X,19:V=57:GOSUB 5685:IF Z<4 THEN 5600
5684 GOSUB 8100:FF=24:GOSUB 9900:C1=5:GOTO 5676
5685 GOSUB 8:Z=INT(ZV/16)-1:IF Z<0 THEN RETURN
5686 T$="VOILIER ABIME   A PERDU UN MAT  AVARIE COQUE    ":T$=MID$(T$,Z*16+1,16):PRINT" "T$;:RETURN
5688 GOSUB 5900:FF=23:X=1:Y=14:GOSUB 8590:ZZ=0:V=0:GOSUB 4910:C=22:GOSUB 8400:RETURN
5690 FF=25:IF FT THEN FF=42:GOTO 5675
5691 GOTO 5675
5700 GOSUB 12500:K=1:XX=1:ZZ=-5:GOSUB 4300:FF=26:GOTO 5676
5710 T$="HISSER LA VOILE  ":V=10:GOSUB 8:IF ZV=1 THEN T$="VOILES DEHORS   "
5715 GOTO 5635
5720 V=10:GOSUB 5739:GOTO 5635
5730 V=63:GOSUB 5739:|Y,23:PRINT:PRINT"";T$;:GOTO 5600
5739 T$="VOILES COMBAT   ":GOSUB 8:IF ZV=1 THEN T$="VOILES DEHORS   "
5740 RETURN
5900 V=58:GOSUB 8:CX=(ZV+1)AND 254:V=57:GOSUB 8:LN=ZV:V=32:GOSUB 8:XM=ZV:RETURN
5920 FOR I=1 TO PEEK(PT+15):ZZ=PEEK(PT+19+I):GOSUB 4290:T$=T$+F$+"£ ":NEXT:RETURN
5950 SL=SGN(SL):|FILL,PR+128,128,0:V=73:ZV=DF+(SK=PEEK(PR+23)AND DF>0)+DZ:IF ZV>4 THEN ZV=4
5980 GOSUB 7:SK=0:RETURN
6000 FF$="SWORD.SPR":|LSP,@FF$:V=1:|CLEAR:V=4:ZV=Y(0):GOSUB 7:V=56:ZV=T(0):GOSUB 7:Z=(Y(0)*Y(1)+T(0)*T(1))/31:V=5:ZV=INT(Y(0)*Y(1)/Z+0.5)+8:GOSUB 7:V=57:ZV=47-ZV:GOSUB 7:SK=1:GOSUB 5950:DZ=0:V=3:ZV=C-2:GOSUB 7:INK 7,26
6050 V=23:ZV=DL:GOSUB 7:CALL &8503
6100 |T,&6A00:ON PEEK(A0)GOTO 6110,6110,6110,6130
6110 V=4:GOSUB 8:Y(0)=ZV:V=2-PEEK(A0):FF$="SHIPS.SPR":|LSP,@FF$:RETURN
6130 |Y,20:PRINT:PRINT"		MORALE:";:V=57:GOSUB 8:ZV=INT(ZV/8):GOSUB 6190:V=5:GOSUB 8:ZV=INT(ZV/8):GOSUB 6190:GOTO 6100
6190 PRINT MID$("AFFOLETREMBLIRRITEFERME SOLIDEFOU!  FOU!! ",ZV*6+1,6)"";:RETURN
6500 GOSUB 12500:F$="SUNSIGHT":X=-10:Y=6:C1=0:C2=15:GOSUB 8100:|CLEAR:INK 8,26:INK 6,26:|Y,21:PRINT:PRINT"    LATITUDE: ?? N":GOSUB 5950:IF DF=0 THEN PRINT"
   ESTIME DE LA LONGITUDE:"INT(96.7-PEEK(PT+1)*0.24)"W";
6600 CALL &8503:|T,&5E00:ZZ=1:GOSUB 9000:RETURN
6700 F$="SCAPE":GOSUB 12900:GOSUB 5950:V=23:ZV=CP:GOSUB 7:GOSUB 12500:|MOVE,DT+410,PR+128,25:V=33:ZV=FT:GOSUB 7:GOSUB 12950:INK 0,2:IF FT THEN|Y,20:PRINT SPACE$(200):RETURN
6705 |Y,21:PRINT:PRINT SPACE$(120):|Y,21:PRINT:PRINT" PIRATE PARTY  DEFENSEURS ":T$="     HMS     MUSKETS":PRINT T$;T$;:T$="         TER :  ":PRINT T$""T$;:F$="BATTLE":GOSUB 12900:V=23:ZV=CP:GOSUB 7:DZ=0
6730 GOSUB 12950:ZZ=0:GOSUB 3980:ON PEEK(A0)GOTO 6750,6760,6770,6755
6750 Z=6
6752 V=Z:GOSUB 8:ZV=INT(ZV/16):|Y,22:PRINT:|X,Z*1.3+34:GOSUB 6190:GOTO 6730
6755 Z=21:GOTO 6752
6760 V=1
6765 V1=V:V=7:GOSUB 8:V=V1:WA=WA+ZV:GOSUB 12500:IF V=0 THEN X=3:Y=3:FF=62:GOSUB 8590
6767 RETURN
6770 V=0:GOTO 6765
7000 F$="JOURNAL DE NAVIRE":RR=1
7010 GOSUB 12500:PRINT CHR$(30);"
		*** "F$" ***":K=PEEK(LG)-21:IF K<0 THEN K=-1:GOTO 7060
7030 A=LG+K*4+1:Z=FNDP(A):I=PEEK(A+2):J=1-2*((I>9)AND(I<20)):IF((J AND RR)=0)OR((Z>TV AND J=3))THEN 7060
7035 Z=Z-360*INT(Z/360):ZZ=INT(Z/30):GOSUB 1099:PRINT""T$;:Z=(Z-ZZ*30+1):PRINT Z;:|X,6:PRINT"-";:Z=PEEK(A+2):ON INT((Z-1)/10)GOTO 7052,7053:ON Z GOSUB 7110,7120,7130,7140,7150,7160,7162,7164,7170,7180:GOTO 7060
7052 ON Z-10 GOSUB 7190,7200,7210,7220,7230,7240,7255,7250,7260,7270:GOTO 7060
7053 ON Z-20 GOSUB 7280,7300,7310,7320,7330,7340:GOTO 7060
7060 K=K+1:IF K<PEEK(LG)THEN 7030
7070 PRINT"... FIN  ...";:GOSUB 2990:RETURN
7110 PRINT"VISITEUR";
7115 A=CT+(PEEK(A+3)AND 63)*CL:GOSUB 2950:PRINT" "C$".":RETURN
7120 Z=INT(PEEK(A+3)/64):GOSUB 2195:PRINT"SOUS LE TITRE DE "CO$;F$""RK$(PEEK(A+3)AND 63)".":RETURN
7130 PRINT"PILLE";:GOTO 7115
7140 PRINT"CAPTURE DE ";
7145 Z=INT(PEEK(A+3)/16):GOSUB 2195:PRINT CO$;F$;"";:ZZ=PEEK(A+3)AND 15:GOSUB 4290:PRINT""F$:RETURN
7150 PRINT"COULE UN ";:GOTO 7145
7160 PRINT"ENGAGE UN ";:GOTO 7145
7164 PRINT"TRESOR TROUVE":RETURN
7170 Z=PEEK(TR+24+4*8+INT(PEEK(A+3)/64)*8+1):GOSUB 2290:PRINT" "CO$" IN";:GOTO 7115
7180 ZZ=PEEK(A+3):GOSUB 7245:PRINT"AMNISESTE PROPOSEE AU PIRATE!":RETURN
7190 PRINT"ATTAQUE INDIENS";:GOTO 7115 
7200 PRINT"MINE D'OR A";:GOTO 7115
7210 PRINT"MALARIA DECIME";:GOTO 7115
7220 PRINT"NOUVEAU GOUVERNEUR";:GOTO 7115
7230 PRINT"PILLAGE PIRATES";:GOTO 7115
7240 ZZ=PEEK(A+3):GOSUB 7245:PRINT"EN GUERRE AVEC ";:GOSUB 7245:PRINT".":RETURN
7245 F$=MID$("ESPAGNEANGLET.FRANCE HOLLAN.PIRATE ",(ZZ AND 3)*8+1,8):GOSUB 2197:PRINT F$"";:ZZ=INT(ZZ/4):RETURN
7250 ZZ=PEEK(A+3):GOSUB 7245:PRINT"ALLIES A ";:GOSUB 7245:PRINT".":RETURN
7255 ZZ=PEEK(A+3):GOSUB 7245:PRINT"ET ";:GOSUB 7245:PRINT"FAIRE LA PAIX.":RETURN
7260 ZZ=PEEK(PEEK(A+3)*CL+CT+3):GOSUB 7245:PRINT"CAPTURES";:GOTO 7115
7270 PRINT"FLOTTE AU TRESOR A";:GOTO 7115
7280 PRINT"TRAIN D'ARGENT A";:GOTO 7115
7320 PRINT"A CAPTURE LA FLOTTE AU TRESOR":RETURN
7330 PRINT"A CAPTURE LE TRAIN D'ARGENT":RETURN
7340 Z=PEEK(A+3):GOSUB 8430:PRINT"A SAUVE MON ";T$:RETURN
7880 C2=PEEK(SA)+PEEK(SA+1)*16:GOTO 7900
7890 C2=INT((CP-CT)/CL)
7900 AA=PEEK(LG):IF AA>=62 THEN|MOVE,LG+128,LG,128:AA=AA-32
7910 POKE LG,AA+1:AA=LG+1+AA*4:POKE AA+2,C1:POKE AA+3,C2:C1=DAY+360*YR:POKE AA,FNLB(C1):POKE AA+1,INT(C1/KP):RETURN
7999 X=20-INT(LEN(T$)/2):Y=20:GOSUB 8005:FOR I=0 TO 200:NEXT:RETURN
8000 C=0:GOTO 8010
8005 C=1
8010 PRINT"";:AX=PR+131:POKE AX-1,0:T$=CHR$(163)+T$:|PARSE,@T$:XL=PEEK(AX-2):DX=XL+2:N=PEEK(AX-3):DY=N+1:IF(X+DX)>39 THEN DX=39-X
8030 IF(Y+DY)>24 THEN DY=24-Y
8035 CO=1+INT(RND*15):IF CO=6 THEN CO=15
8036 IF CO=7 THEN CO=12
8037 GOSUB 30:Z=PEEK(AX+15):|Y,Y:PRINT"
";:FOR I=AX+1 TO AX+n:|X,X+1:IF Z=I THEN PRINT"";
8045 PRINT MID$(T$,PEEK(I-1)+1,PEEK(I)-PEEK(I-1)):NEXT:PRINT"";:IF C THEN RETURN
8050 IF SG>=0 THEN GOSUB 8700
8055 IF PEEK(A1)=PEEK(A2)THEN 2990
8060 |CONTR:C=PEEK(A0):RETURN:X=1:Y=1:GOTO 8099:X=17:Y=1:GOTO 8099
8097 X=1:Y=9:GOTO 8099
8099 C1=0:C2=10:XX=XX+1
8100 IF X>0 AND RND>PX THEN RD=0:RETURN
8110 DX=FRE(""):DX=19:X1=X:IF X=-1 THEN X1=ABS(X):DX=(DX*2)-1
8120 IF X<0 AND X<>-1 THEN X=ABS(X)
8130 POKE 46546,XX:XX=0:F$=F$+".WIN":|DPIC,X,Y,DX,15,1,@F$:RETURN:IF X=-1 THEN X=0:Z=Z+18:RR=RR+18:GOTO 8140
8160 PX=0.7-DF*0.15:RETURN
8180 GOSUB 9900:GOSUB 9900:SG=2:POKE CP,PEEK(CP)OR 128:XX=1:X=-11:Y=9:F$="HAPPY":RD=14:GOSUB 8099:X=2:Y=1:FF=52:GOSUB 8590:X=12:Y=4:Z=INT((WA-12)/15):IF Z>2 THEN Z=2
8183 IF Z>-1 THEN CO$=MID$("UN PEU  BEAUCOUPPLUS DE ",Z*8+1,8):FF=41:GOSUB 8590
8190 FOR I=1 TO 4:T(I)=INT(RND*PEEK(CP+8))-50*(I=0):P(I)=0:NEXT:F$=C$:P(0)=0:T(0)=INT(PEEK(CP+7)*1500/(15+WA)):FOR K=1 TO 2:IF CC<>PEEK(PR-K)THEN 8194
8192 POKE PR-K,255:C1=23+K:GOSUB 7900:X=8:Y=10:FF=49+K:GOSUB 8590:T(0)=T(0)+20*PEEK(DT+KP+20*7+5):POKE PR+26+K,16
8194 NEXT:POKE CP+7,FNRG(PEEK(CP+7)-T(0)/50):POKE CP+8,FNRG(PEEK(CP+8)-20):C=-NN-8:GOSUB 8400:IF T(0)>99 THEN GOSUB 8400:GOSUB 8400:C=4:GOSUB 8400:GOSUB 8400
8196 POKE CP+9,(PEEK(CP+9)-3)AND 255:IF ME<PEEK(CP+6)*10*(1+RND)THEN 8199
8197 X=3:Y=3:FF=39:GOSUB 8590:POKE CP+3,C-5:POKE CP+9,2:POKE CP+11,RND*16:IF C-5<>NN THEN POKE PR+3+C,(PEEK(PR+3+C)+3)AND 255:C=-NN-8:GOSUB 8400:GOSUB 8400:NN=C-5
8199 T(4)=6*PEEK(CP+4):C1=3:GOSUB 7890:T$="TOWN":GOTO 8210
8210 GOSUB 12500:ZZ=(P(0)<>0 OR T(0)=0):X=1:Y=-ZZ:DX=37:DY=11+ZZ:CO=1+4*P(0):GOSUB 30:|CLEAR:|Y,1:PRINT:PRINT""NA$" "T$"";:CO$=CHR$(0):IF P(0)THEN PRINT" PRIX":CO$=""
8225 LOCATE 1,10:PRINT"		  TRANSFERE LA CARGAISON,":PRINT"		  PUIS APPUYER SUR LA TOUCHE.":IF ZZ=0 THEN PRINT CHR$(30)"
"T(0)"0 PCS. D'OR PILLEE!":ZZ=-T(0):GOSUB 3990:T(0)=0
8230 |Y,2:PRINT:PRINT"		OR      "P$,CO$""P$:T$="     TONS":PRINT"		ALIMENT"T$""T$""CO$;P(1)P$:PRINT"		BIENS"T$""T$""CO$;P(2)P$:PRINT"		"X$""T$""T$""CO$;P(3)P$:PRINT"		CANON"CO$;P(4)P$
8246 PRINT"				ESPACE DANS CALE:";T$:IF CX<0 THEN CX=CX+KK 
8250 GOSUB 5950:V=7:ZV=T(0):GOSUB 7:FOR I=1 TO 4:V=11+I:ZV=T(I):GOSUB 7:V=15+I:ZV=P(I):GOSUB 7:NEXT:V=26:ZV=VA:GOSUB 7:CALL &8503:|T,&5C00:RETURN
8290 Y(0)=1:Y(1)=9:T(0)=1:T(1)=9:DL=1:GOTO 8305
8300 DL=0
8305 GOSUB 12500:X=-1:Y=2:C1=11:C2=9:GOSUB 8100:F$=T$:X=23:Y=17:T$="QUELLE ARMÅEMPLOYEZ-VOUS¿ RAPIERÅ EPEÅ SABRÅ":GOSUB 8000:T$=F$:|WINDOW,1,18,30,4,2:CO$="":F$="":IF LEN(T$)<12 AND DL=0 THEN Z=NN:GOSUB 2195
8320 O$="
"+NA$+" VS. "+CO$+F$+""+T$:|X,40-LEN(O$):PRINT O$:IF LEN(T$)>10 THEN T$="ENEMY"
8330 |Y,18:PRINT:PRINT""T$""NA$:PRINT"		FORCE:    HMS    HMS":GOSUB 6000:GOSUB 12500:X=2:Y=2:IF V<>1 AND DL THEN FF=32:GOSUB 8590:POKE PR+4,255:GOTO 8393
8389 IF V=-1 THEN 8395
8392 IF DL=0 THEN ZZ=Y(0)-ME:GOSUB 3980
8393 RETURN
8395 C=22:GOSUB 8400:X=-2:Y=9:XX=1:F$="PRISON":GOSUB 8100:X=1:Y=1:A=CP:GOSUB 2950:A$=C$:FF=33:IF NN<>PEEK(CP+3)OR CC>NC THEN C$="LE NAVIRE"
8397 GOSUB 8595:F$="ISLAND":IF C$=A$THEN GOSUB 12900:GOSUB 5950:V=23:ZV=CP:GOSUB 7:GOSUB 12950:V=3:GOSUB 8:SL=ZV
8399 C$=A$:GOSUB 4990:FF=3:X=6:Y=10:GOSUB 8590:V=0:RETURN
8400 POKE PR+ABS(C),(PEEK(PR+ABS(C))+SGN(C))AND 255:C1=ABS(C)-8:A=PR+64+C1*4:IF C1<0 OR C1>3 THEN RETURN
8406 FOR I=0 TO 3:POKE PR+8+I,(PEEK(PR+8+I)+SGN(C)*SGN(FNEX(A+I))AND 255):NEXT:RETURN
8420 Z=INT(FNEX(PR+4)/4)*10+11:IF Z<1 THEN Z=1
8421 IF Z>51 THEN Z=51
8422 F$=MID$("LACHEMENT PROMETTEURTRES CONNUCELEBRE   FAMEUX    VIL      ",Z,10)
8430 T$=MID$("SOEUR PERE  MERE  ONCLE ",Z*6+1,6):RETURN
8435 Z=INT((YR-PEEK(PR+19)+PEEK(PR+22))/(3-(PEEK(PR+23)=4))):IF Z>4 THEN Z=4
8436 T$=MID$("FIN   BIEN  BONNE PAUVREPAUVRE",Z*6+1,6):RETURN
8440 Z=INT(FNEX(PT+17)/4)+1:IF Z>3 THEN Z=3
8441 IF Z<0 THEN Z=0
8442 f$="":F$=MID$("IRRITE TRISTE CONTENTHEUREUX",Z*7+1,7):RETURN
8445 f$="":F$=MID$("APPRENTI  COMPAGNON AVENTURIERBRETTEUR  ",DF*10+1,10):RETURN
8450 Y(0)=ME:Y(1)=Y(1)+FNEX(PT+17)/2:RETURN
8500 T$="EQUIPAGE INSUFFISANÔPERTE D'UN VAISSEAU®":X=10:Y=6:IF LL AND 1 THEN RETURN
8505 IF PEEK(PT+15)*8>ME THEN ZZ=PEEK(PT+15)-1:GOSUB 8000:GOSUB 4905:GOTO 8500
8520 GOSUB 8580:IF Z>=0 THEN RETURN
8530 GOSUB 12500:T$="TROP DE CHARGE®":GOSUB 7999:T$="PAR DESSUS BORD":FOR I=0 TO 4:T(I)=0:P(I)=0:NEXT:GOSUB 8210:GOTO 8500
8580 Z=INT(PEEK(PT+5)/2):FOR I=9 TO 11:Z=Z+PEEK(PT+I):NEXT I:Z=PEEK(PT+14)*10-Z:RETURN
8590 GOSUB 8600:T$=T$+"®":GOSUB 8000:RETURN
8595 GOSUB 8600:T$=T$+"®":GOSUB 8005:RETURN
8600 T$=""
8610 |RSECT,FF
8620 F$=SPACE$(38):|GET,@F$:IF F$="CO$"THEN T$=T$+CO$:GOTO 8620
8622 IF F$="C$"THEN T$=T$+C$:GOTO 8620
8625 Z=LEN(F$):IF F$="ZZ"THEN T$=T$+MID$(STR$(ZZ),2)+" ":GOTO 8620
8626 IF F$="ZZ0"THEN T$=T$+MID$(STR$(ZZ),2)+"0 ":GOTO 8620
8630 IF PEEK(A0)=0 THEN T$=T$+LEFT$(F$,Z-1)+CHR$(ASC(MID$(F$,Z))OR 128):GOTO 8620
8640 T$=T$+F$:T$=LEFT$(T$,LEN(T$)-1)+CHR$(ASC(MID$(T$,LEN(T$),1))AND 127):RETURN
8700 IF SG<0 THEN RETURN ELSE|TUNE,INT(RND*6):SG=-1:RETURN
9000 CX=DAY:DAY=DAY+ZZ:IF INT(CX/30)=INT(DAY/30)THEN RETURN
9020 FOR MN=INT(CX/30)+1 TO INT(DAY/30):GOSUB 9100:GOSUB 9180:IF LL OR(ME=1)THEN 9030
9022 IF FNEX(PT+17)>-4 THEN 9028
9025 X=4:Y=4:GOSUB 12500:FF=29:GOSUB 8590:ZZ=-ME/3:GOSUB 3975:DZ=1:F$="DECK":T$="MUTINERIE":GOSUB 8290:POKE PR+7,(PEEK(PR+7)-4)AND 255:GOTO 9030
9028 IF FNEX(PT+17)<0 THEN GOSUB 12500:FF=27:GOSUB 8590
9030 MT=-1:VV=VV*(LL AND 2)/2:NEXT:IF DAY>=360 THEN DAY=DAY-360:YR=YR+1
9040 MN=INT(DAY/30):RETURN
9100 ZZ=MN:GOSUB 1099:T$=T$+STR$(1560+SN*20+YR+INT(MN/12))+CHR$(163):X=9:Y=9:GOSUB 8005:ZZ=PEEK(PR+5)/2:GOSUB 3995:|CLEAR:GOSUB 5950:V=19:ZV=MN:GOSUB 7:V=22:ZV=NC:GOSUB 7:|T,&6650:FOR I=PR+128 TO PR+136 STEP 2:C1=PEEK(I)
9130 IF C1 THEN C2=PEEK(I+1):GOSUB 7900
9140 NEXT:RETURN
9180 Z=SQR(FNDP(PT+7)/FNDP(PT+3)):Z=2*Z:POKE PT+17,(Z-FNEX(PR+7)+4-DF)AND 255:RETURN:RETURN
9900 POKE CP+8,FNRG(PEEK(CP+8)-10):RETURN
12500 CLS:|INX:MO=1:PRINT"";:RETURN
12900 |CLEAR:F$=F$+".SID":|TFILE,@F$,&5600:RETURN
12950 |T,&5600:RETURN:|T,&5600:RETURN
21000 GOSUB 12500:T$="GAME DISK SIDE 1":GOSUB 2490:IF A$<>"1"THEN 21000 ELSE RUN"LIFE
